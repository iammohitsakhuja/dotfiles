#!/usr/bin/env bash

BREW_PREFIX="$(brew --prefix)"

# Go related things.
export GOENV_ROOT="$HOME/.goenv"
PATH="$GOENV_ROOT/bin:$PATH"

# PATH Configuration: GNU Utilities Override
#
# Prioritizes GNU/Linux utilities installed via Homebrew over macOS BSD versions.
# Benefits: Linux compatibility, GNU features, better cross-platform script portability.
#
# Note: May cause behavior differences from standard macOS. For compatibility issues,
# use explicit BSD versions from /usr/bin/ when needed.
PATH="$BREW_PREFIX/opt/curl/bin:$PATH"                                      # Curl.
PATH="$BREW_PREFIX/opt/coreutils/libexec/gnubin:$PATH"                      # Coreutils.
PATH="$BREW_PREFIX/opt/gnu-sed/libexec/gnubin:$PATH"                        # GNU Sed.
PATH="$BREW_PREFIX/opt/gnu-getopt/bin:$PATH"                                # GNU getopt.
PATH="$BREW_PREFIX/opt/grep/libexec/gnubin:$PATH"                           # Grep.
PATH="$BREW_PREFIX/opt/libressl/bin:$PATH"                                  # LibreSSL.
PATH="$BREW_PREFIX/sbin:$PATH"                                              # Homebrew formulae.

# Required by Claude Code.
PATH="$PATH:$HOME/.local/bin"

# Added by LM Studio CLI (lms)
export PATH="$PATH:$HOME/.lmstudio/bin"
# End of LM Studio CLI section

# Android development settings.
export ANDROID_HOME=$HOME/Library/Android/sdk
PATH="$PATH:$ANDROID_HOME/emulator"
PATH="$PATH:$ANDROID_HOME/tools"
PATH="$PATH:$ANDROID_HOME/tools/bin"
PATH="$PATH:$ANDROID_HOME/platform-tools"
PATH="$PATH:$ANDROID_HOME/cmdline-tools/latest/bin"

# Add system frameworks and developer tools to PATH.
PATH="$PATH:/System/Library/Frameworks:/Library/Developer"
export PATH

# Control Zsh history.
export HISTSIZE=100000
export SAVEHIST=$HISTSIZE
export HIST_STAMPS="%F %T"
export HISTCONTROL=ignoreboth
setopt EXTENDED_HISTORY

# Make Neovim the default editor.
export EDITOR="nvim"

# Ensure that any other Terminal multiplexer (like Tmux) does not mess up the
# coloring.
export TERM="xterm-256color-italic"

# Make Python use UTF-8 encoding for output to stdin, stdout, and stderr.
export PYTHONIOENCODING="UTF-8"

# You may need to manually set your Locale.
export LC_ALL="en_US.UTF-8"

# DO NOT DO THIS. Not recommended as it produces extra output which causes problems with other utilities that use FZF.
# But keeping it here for reference purposes.
export FZF_DEFAULT_OPTS='--preview "bat --style=numbers --color=always --line-range :500 {}"'

# Find hidden files with FZF.
export FZF_DEFAULT_COMMAND='fd --hidden --exclude .git'
export FZF_CTRL_T_COMMAND='fd --hidden --exclude .git'

# Currently disabled flags for C compilation. Enable during development, if needed.
# export CFLAGS="-std=c18"

# Currently disabled flags for C++ compilation. Enable during development, if needed.
# export CXXFLAGS="-std=c++20 -Wall -Werror"

# Add, path to custom manpages to the MANPATH variable.
# Also, update MANPATH so that there is no need to prefix 'g' for utilities
# like sha256sum and sha512sum.
MANPATH="/usr/local/opt/coreutils/libexec/gnuman:$MANPATH"
export MANPATH="$MANPATH:/usr/local/man:/usr/local/share/man:/usr/share/man:/usr/man"

############################# Colors for Manpages #############################

# Colors.
default=$(tput sgr0)
red=$(tput setaf 1)
green=$(tput setaf 2)
purple=$(tput setaf 5)
orange=$(tput setaf 9)

# Less colors for man pages.
export PAGER=less
# Begin blinking.
export LESS_TERMCAP_mb=$red
# Begin bold.
export LESS_TERMCAP_md=$orange
# End mode.
export LESS_TERMCAP_me=$default
# End standout-mode.
export LESS_TERMCAP_se=$default
# Begin standout-mode - info box.
export LESS_TERMCAP_so=$purple
# End underline.
export LESS_TERMCAP_ue=$default
# Begin underline.
export LESS_TERMCAP_us=$green

############################# Miscellaneous #############################

# Disable Virtualenv's prompt.
export VIRTUAL_ENV_DISABLE_PROMPT=1

# Disable security audit of folders that `oh-my-zsh` uses for completions.
# In particular, they are:
#   /usr/local/share/zsh
#   /usr/local/share/zsh/site-functions
# This command can help as well:
#   compaudit | xargs chmod g-w,o-w
# export ZSH_DISABLE_COMPFIX=true
